!function(t){var e={};function r(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(o,i,function(e){return t[e]}.bind(null,i));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([,function(t,e,r){"use strict";e.__esModule=!0;var o=r(2),i=o.GifWriter,n=o.IndexedColorImage,a=o.MedianCutColorReducer,s=function(){function t(){this.buffer=[]}return t.prototype.writeByte=function(t){this.buffer.push(t)},t.prototype.writeBytes=function(t){Array.prototype.push.apply(this.buffer,t)},t}();self.onmessage=function(t){var e=t.data,r=e.imageDataList,o=e.paletteSize,u=e.delayTimeInMS,l=e.imageSize,h=r.map((function(t){return function(t,e){for(var r=new a(t,e),o=r.process(),i=Array.prototype.slice.call(t.data),s=[],u=0,l=i.length;u<l;u+=4){var h=i.slice(u,u+4);s.push(r.map(h[0],h[1],h[2]))}return new n({width:t.width,height:t.height},s,o)}(t,o)})),_=new s,c=new i(_);c.writeHeader(),c.writeLogicalScreenInfo({width:l,height:l}),c.writeLoopControlInfo(0),h.forEach((function(t){c.writeTableBasedImageWithGraphicControl(t,{delayTimeInMS:u})})),c.writeTrailer();var f=_.buffer.map((function(t){return String.fromCharCode(t)})).join("");self.postMessage({gifDataStr:f})}},function(t,e,r){"use strict";var o=this&&this.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||o(e,t,r)};e.__esModule=!0,i(r(3),e),i(r(4),e)},function(t,e,r){"use strict";e.__esModule=!0,e.GifWriter=e.IndexedColorImage=void 0;var o=function(t,e,r){this.width=t.width,this.height=t.height,this.data=e,this.paletteData=r};e.IndexedColorImage=o;var i=function(){function t(){this.__out=[],this.__remNumBits=0,this.__remVal=0}return t.prototype.push=function(t,e){for(;e>0;)this.__remVal=(t<<this.__remNumBits&255)+this.__remVal,e+this.__remNumBits>=8?(this.__out.push(this.__remVal),e-=8-this.__remNumBits,t>>=8-this.__remNumBits,this.__remVal=0,this.__remNumBits=0):(this.__remNumBits=e+this.__remNumBits,e=0)},t.prototype.flush=function(){this.push(0,8),this.__remNumBits=0,this.__remVal=0;var t=this.__out;return this.__out=[],t},t}();var n=function(){function t(t){this.__os=t}return t.prototype.__writeInt2=function(t){this.__os.writeBytes([255&t,t>>8&255])},t.prototype.__writeDataSubBlocks=function(t){for(var e,r=this.__os,o=0;o<(e=Math.min(t.length,o+254));){var i=t.slice(o,e);r.writeByte(i.length),r.writeBytes(i),o=e}},t.prototype.__writeBlockTerminator=function(){this.__os.writeByte(0)},t.prototype.writeHeader=function(){var t=this.__os;t.writeBytes([71,73,70]),t.writeBytes([56,57,97])},t.prototype.writeTrailer=function(){this.__os.writeByte(59)},t.prototype.writeLogicalScreenInfo=function(t,e){var r,o,i;e||(e={});var n=null!==(r=e.sizeOfColorTable)&&void 0!==r?r:e.colorTableData?this.__calcSizeOfColorTable(e.colorTableData):7,a=null!==(o=e.bgColorIndex)&&void 0!==o?o:0,s=null!==(i=e.pxAspectRatio)&&void 0!==i?i:0;this.__writeLogicalScreenDescriptor(t,!!e.colorTableData,!!e.colorTableSortFlag,n,a,s),e.colorTableData&&this.__writeColorTable(e.colorTableData,n)},t.prototype.__calcSizeOfColorTable=function(t){for(var e=t.length/3,r=0,o=2;o<e;)r++,o<<=1;return r},t.prototype.__writeLogicalScreenDescriptor=function(t,e,r,o,i,n){var a=this.__os;this.__writeInt2(t.width),this.__writeInt2(t.height),a.writeByte(112|(e?128:0)|(r?8:0)|o),a.writeByte(i),a.writeByte(n)},t.prototype.writeTableBasedImage=function(t,e){e||(e={});var r=this.__calcSizeOfColorTable(t.paletteData);this.__writeImageDescriptor(t,!0,r,e),this.__writeColorTable(t.paletteData,r),this.__writeImageData(t.data,r+1)},t.prototype.writeTableBasedImageWithGraphicControl=function(t,e){this.__writeGraphicControlExtension(e),this.writeTableBasedImage(t,e)},t.prototype.__writeImageDescriptor=function(t,e,r,o){var i,n,a=this.__os;a.writeByte(44);var s=null!==(i=null==o?void 0:o.leftPosition)&&void 0!==i?i:0;this.__writeInt2(s);var u=null!==(n=null==o?void 0:o.topPosition)&&void 0!==n?n:0;this.__writeInt2(u),this.__writeInt2(t.width),this.__writeInt2(t.height),a.writeByte(0|(e?128:0)|r)},t.prototype.__writeImageData=function(t,e){var r=this.__os;1===e&&(e=2);var o=function(t,e){var r=new i,o=1<<e,n=o+1,a=0,s=0,u=Object.create(null);function l(){a=n+1,s=e+1,u=Object.create(null)}l(),r.push(o,s);for(var h="",_=0,c=t.length;_<c;++_){var f=t[_],p=String.fromCharCode(f);p in u||(u[p]=f);var d=h;(h+=p)in u||(r.push(u[d],s),a<=4095?(u[h]=a,a===1<<s&&s++,a++):(r.push(o,s),l(),u[p]=f),h=p)}return r.push(u[h],s),r.push(n,s),r.flush()}(t,e);r.writeByte(e),this.__writeDataSubBlocks(o),this.__writeBlockTerminator()},t.prototype.__writeColorTable=function(t,e){var r=this.__os;r.writeBytes(t);for(var o=3*Math.pow(2,e+1)-t.length,i=[];--o>=0;)i.push(0);r.writeBytes(i)},t.prototype.__writeGraphicControlExtension=function(t){var e,r;t||(t={});var o,i,n=this.__os,a=Math.round((null!==(e=t.delayTimeInMS)&&void 0!==e?e:0)/10),s=null!==(r=t.disposalMethod)&&void 0!==r?r:2;void 0!==t.transparentColorIndex&&t.transparentColorIndex>=0?(o=255&t.transparentColorIndex,i=1):(o=0,i=0),n.writeBytes([33,249,4]),n.writeByte(0|s<<2|i),this.__writeInt2(a),n.writeByte(o),n.writeByte(0)},t.prototype.writeLoopControlInfo=function(t){this.__os.writeBytes([33,255,11,78,69,84,83,67,65,80,69,50,46,48,3,1,255&t,t>>8&255,0])},t}();e.GifWriter=n},function(t,e,r){"use strict";e.__esModule=!0,e.MedianCutColorReducer=void 0;var o=r(5);var i=function(){function t(t){this.colors=t;var e=255,r=0,o=255,i=0,n=255,a=0;t.forEach((function(t){t.red<e&&(e=t.red),t.red>r&&(r=t.red),t.green<o&&(o=t.green),t.green>i&&(i=t.green),t.blue<n&&(n=t.blue),t.blue>a&&(a=t.blue)})),this.__minR=e,this.__maxR=r,this.__minG=o,this.__maxG=i,this.__minB=n,this.__maxB=a}return t.prototype.divide=function(){var t=this.largestEdge(),e=this.median(t);return this.divideBy(t,e)},t.prototype.divideBy=function(e,r){var o=[],i=[];return this.colors.forEach((function(t){t[e]<r?o.push(t):i.push(t)})),o.length>0&&i.length>0?[new t(o),new t(i)]:[]},t.prototype.median=function(t){for(var e=[],r=this.colors,i=0,n=r.length;i<n;++i)e.push(r[i][t]);return o.selectKthElem(e,Math.floor(e.length/2)+1)},t.prototype.largestEdge=function(){var t=1*(this.__maxR-this.__minR),e=.8*(this.__maxG-this.__minG),r=.5*(this.__maxB-this.__minB);return e>=r?t>=e?"red":"green":t>=r?"red":"blue"},t.prototype.getNumberOfColors=function(){return this.colors.length},t.prototype.average=function(){var t=0,e=0,r=0;this.colors.forEach((function(o){t+=o.red,e+=o.green,r+=o.blue}));var o=this.colors.length;return{red:Math.floor(t/o),green:Math.floor(e/o),blue:Math.floor(r/o)}},t}(),n=function(){function t(t,e){this.__palette=[],this.__colorReductionMap={},this.__imageData=t,this.__maxPaletteSize=e||255}return t.prototype.process=function(){var t=this.__imageData,e=this.__maxPaletteSize,r=this.__extractColors(t),o=this.__medianCut(r,e),i=[],n=Object.create(null);o.forEach((function(t,e){i.push(t.average()),t.colors.forEach((function(t){for(var r=(t.red<<16|t.green<<8|t.blue<<0).toString(16);6-r.length;)r="0"+r;n[r]=e}))})),this.__palette=i,this.__colorReductionMap=n;var a=[];return i.forEach((function(t){a.push(t.red),a.push(t.green),a.push(t.blue)})),a},t.prototype.map=function(t,e,r){for(var o,i,n,a,s,u,l=(t<<16|e<<8|r<<0).toString(16);6-l.length;)l="0"+l;return l in this.__colorReductionMap||(this.__colorReductionMap[l]=(o={red:t,green:e,blue:r},i=this.__palette,n=0,a=!1,s=-1,u=-1,i.forEach((function(t,e){var r=Math.floor(Math.pow(o.red-t.red,2)+Math.pow(o.green-t.green,2)+Math.pow(o.blue-t.blue,2));0==r?(a=!0,s=e,u=e):(0==n||r<n)&&(u=e,n=r)})),a?s:u)),this.__colorReductionMap[l]},t.prototype.__extractColors=function(t){for(var e=t.width*t.height,r={},o=[],i=0;i<e;++i){for(var n=t.data[4*i+0],a=t.data[4*i+1],s=t.data[4*i+2],u=(n<<16|a<<8|s<<0).toString(16);6-u.length;)u="0"+u;r[u]||(r[u]=!0,o.push({red:n,green:a,blue:s}))}return o},t.prototype.__medianCut=function(t,e){var r=new i(t);return this.__divideUntil([r],e)},t.prototype.__divideUntil=function(t,e){for(;!(t.length>=e);){var r=this.__getLargestCube(t),o=r.divide();if(o.length<2)break;t=t.filter((function(t){return t!==r})).concat(o)}return t},t.prototype.__getLargestCube=function(t){var e,r=0;if(t.forEach((function(t){var o=t.getNumberOfColors();o>r&&(e=t,r=o)})),void 0===e)throw Error("`cubes` must have one or more elements.");return e},t}();e.MedianCutColorReducer=n},function(t,e,r){"use strict";function o(t,e,r){var o=t[e];t[e]=t[r],t[r]=o}function i(t,e,r,i){var n=t[i];o(t,i,r);for(var a=e,s=e;s<r;++s)t[s]<=n&&(o(t,a,s),a+=1);return o(t,r,a),a}e.__esModule=!0,e.selectKthElem=void 0,e.selectKthElem=function(t,e){return function(t,e,r,o){for(;;){var n=Math.floor((r+e)/2),a=i(t,e,r,n),s=a-e+1;if(o===s)return t[a];o<s?r=a-1:(o-=s,e=a+1)}}(t,0,t.length-1,e)}}]);