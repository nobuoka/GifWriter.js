!function(t){var e={};function r(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(i,o,function(e){return t[e]}.bind(null,o));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([,function(t,e,r){"use strict";e.__esModule=!0;var i=r(2),o=i.GifWriter,n=i.IndexedColorImage,a=i.MedianCutColorReducer,s=function(){function t(){this.buffer=[]}return t.prototype.writeByte=function(t){this.buffer.push(t)},t.prototype.writeBytes=function(t){Array.prototype.push.apply(this.buffer,t)},t}();self.onmessage=function(t){var e=t.data,r=e.imageDataList,i=e.paletteSize,u=e.delayTimeInMS,h=e.imageSize,_=r.map((function(t){return function(t,e){for(var r=new a(t,e),i=r.process(),o=Array.prototype.slice.call(t.data),s=[],u=0,h=o.length;u<h;u+=4){var _=o.slice(u,u+4);s.push(r.map(_[0],_[1],_[2]))}return new n({width:t.width,height:t.height},s,i)}(t,i)})),l=new s,c=new o(l);c.writeHeader(),c.writeLogicalScreenInfo({width:h,height:h}),c.writeLoopControlInfo(0),_.forEach((function(t){c.writeTableBasedImageWithGraphicControl(t,{delayTimeInMS:u})})),c.writeTrailer();var f=l.buffer.map((function(t){return String.fromCharCode(t)})).join("");self.postMessage({gifDataStr:f})}},function(t,e,r){"use strict";function i(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}i(r(3)),i(r(4))},function(t,e,r){"use strict";var i=function(t,e,r){this.width=t.width,this.height=t.height,this.data=e,this.paletteData=r};e.IndexedColorImage=i;var o=function(){function t(){this.__out=[],this.__remNumBits=0,this.__remVal=0}return t.prototype.push=function(t,e){for(;e>0;)this.__remVal=(t<<this.__remNumBits&255)+this.__remVal,e+this.__remNumBits>=8?(this.__out.push(this.__remVal),e-=8-this.__remNumBits,t>>=8-this.__remNumBits,this.__remVal=0,this.__remNumBits=0):(this.__remNumBits=e+this.__remNumBits,e=0)},t.prototype.flush=function(){this.push(0,8),this.__remNumBits=0,this.__remVal=0;var t=this.__out;return this.__out=[],t},t}();var n=function(){function t(t){this.__os=t}return t.prototype.__writeInt2=function(t){this.__os.writeBytes([255&t,t>>8&255])},t.prototype.__writeDataSubBlocks=function(t){for(var e,r=this.__os,i=0;i<(e=Math.min(t.length,i+254));){var o=t.slice(i,e);r.writeByte(o.length),r.writeBytes(o),i=e}},t.prototype.__writeBlockTerminator=function(){this.__os.writeByte(0)},t.prototype.writeHeader=function(){var t=this.__os;t.writeBytes([71,73,70]),t.writeBytes([56,57,97])},t.prototype.writeTrailer=function(){this.__os.writeByte(59)},t.prototype.writeLogicalScreenInfo=function(t,e){e||(e={});var r="sizeOfColorTable"in e?e.sizeOfColorTable:e.colorTableData?this.__calcSizeOfColorTable(e.colorTableData):7,i="bgColorIndex"in e?e.bgColorIndex:0,o="pxAspectRatio"in e?e.pxAspectRatio:0;this.__writeLogicalScreenDescriptor(t,!!e.colorTableData,!!e.colorTableSortFlag,r,i,o),e.colorTableData&&this.__writeColorTable(e.colorTableData,r)},t.prototype.__calcSizeOfColorTable=function(t){for(var e=t.length/3,r=0,i=2;i<e;)r++,i<<=1;return r},t.prototype.__writeLogicalScreenDescriptor=function(t,e,r,i,o,n){var a=this.__os;this.__writeInt2(t.width),this.__writeInt2(t.height),a.writeByte(112|(e?128:0)|(r?8:0)|i),a.writeByte(o),a.writeByte(n)},t.prototype.writeTableBasedImage=function(t,e){e||(e={});var r=this.__calcSizeOfColorTable(t.paletteData);this.__writeImageDescriptor(t,!0,r,e),this.__writeColorTable(t.paletteData,r),this.__writeImageData(t.data,r+1)},t.prototype.writeTableBasedImageWithGraphicControl=function(t,e){this.__writeGraphicControlExtension(e),this.writeTableBasedImage(t,e)},t.prototype.__writeImageDescriptor=function(t,e,r,i){var o=this.__os;o.writeByte(44);var n="leftPosition"in i?i.leftPosition:0;this.__writeInt2(n);var a="topPosition"in i?i.topPosition:0;this.__writeInt2(a),this.__writeInt2(t.width),this.__writeInt2(t.height),o.writeByte(0|(e?128:0)|r)},t.prototype.__writeImageData=function(t,e){var r=this.__os;1===e&&(e=2);var i=function(t,e){var r,i,n,a=new o,s=1<<e,u=s+1;function h(){r=u+1,i=e+1,n=Object.create(null)}h(),a.push(s,i);for(var _="",l=0,c=t.length;l<c;++l){var f=t[l],p=String.fromCharCode(f);p in n||(n[p]=f);var d=_;(_+=p)in n||(a.push(n[d],i),r<=4095?(n[_]=r,r===1<<i&&i++,r++):(a.push(s,i),h(),n[p]=f),_=p)}return a.push(n[_],i),a.push(u,i),a.flush()}(t,e);r.writeByte(e),this.__writeDataSubBlocks(i),this.__writeBlockTerminator()},t.prototype.__writeColorTable=function(t,e){var r=this.__os;r.writeBytes(t);for(var i=3*Math.pow(2,e+1)-t.length,o=[];--i>=0;)o.push(0);r.writeBytes(o)},t.prototype.__writeGraphicControlExtension=function(t){t||(t={});var e,r,i=this.__os,o=Math.round((t.delayTimeInMS||0)/10),n="disposalMethod"in t?t.disposalMethod:2;t.transparentColorIndex>=0?(e=255&t.transparentColorIndex,r=1):(e=0,r=0),i.writeBytes([33,249,4]),i.writeByte(0|n<<2|r),this.__writeInt2(o),i.writeByte(e),i.writeByte(0)},t.prototype.writeLoopControlInfo=function(t){this.__os.writeBytes([33,255,11,78,69,84,83,67,65,80,69,50,46,48,3,1,255&t,t>>8&255,0])},t}();e.GifWriter=n},function(t,e,r){"use strict";function i(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function o(t,e,r,o){var n=t[o];i(t,o,r);for(var a=e,s=e;s<r;++s)t[s]<=n&&(i(t,a,s),a+=1);return i(t,r,a),a}function n(t,e){var r=0,i=!1,o=-1,n=-1;return e.forEach((function(e,a){var s=Math.floor(Math.pow(t.red-e.red,2)+Math.pow(t.green-e.green,2)+Math.pow(t.blue-e.blue,2));0==s?(i=!0,o=a,n=a):(0==r||s<r)&&(n=a,r=s)})),i?o:n}var a=function(){function t(t){this.colors=t;var e=255,r=0,i=255,o=0,n=255,a=0;t.forEach((function(t){t.red<e&&(e=t.red),t.red>r&&(r=t.red),t.green<i&&(i=t.green),t.green>o&&(o=t.green),t.blue<n&&(n=t.blue),t.blue>a&&(a=t.blue)})),this.__minR=e,this.__maxR=r,this.__minG=i,this.__maxG=o,this.__minB=n,this.__maxB=a}return t.prototype.divide=function(){var t=this.largestEdge(),e=this.median(t);return this.divideBy(t,e)},t.prototype.divideBy=function(e,r){var i=[],o=[];return this.colors.forEach((function(t){t[e]<r?i.push(t):o.push(t)})),i.length>0&&o.length>0?[new t(i),new t(o)]:[]},t.prototype.median=function(t){for(var e=[],r=this.colors,i=0,n=r.length;i<n;++i)e.push(r[i][t]);return function(t,e,r,i){for(;;){var n=o(t,e,r,Math.floor((r+e)/2)),a=n-e+1;if(i===a)return t[n];i<a?r=n-1:(i-=a,e=n+1)}}(e,0,e.length-1,Math.floor(e.length/2)+1)},t.prototype.largestEdge=function(){var t=1*(this.__maxR-this.__minR),e=.8*(this.__maxG-this.__minG),r=.5*(this.__maxB-this.__minB);return e>=r?t>=e?"red":"green":t>=r?"red":"blue"},t.prototype.getNumberOfColors=function(){return this.colors.length},t.prototype.average=function(){var t=0,e=0,r=0;this.colors.forEach((function(i){t+=i.red,e+=i.green,r+=i.blue}));var i=this.colors.length;return{red:Math.floor(t/i),green:Math.floor(e/i),blue:Math.floor(r/i)}},t}(),s=function(){function t(t,e){this.__imageData=t,this.__maxPaletteSize=e||255}return t.prototype.process=function(){var t=this.__imageData,e=this.__maxPaletteSize,r=this.__extractColors(t),i=this.__medianCut(r,e),o=[],n=Object.create(null);i.forEach((function(t,e){o.push(t.average()),t.colors.forEach((function(t){for(var r=(t.red<<16|t.green<<8|t.blue<<0).toString(16);6-r.length;)r="0"+r;n[r]=e}))})),this.__palette=o,this.__colorReductionMap=n;var a=[];return o.forEach((function(t){a.push(t.red),a.push(t.green),a.push(t.blue)})),a},t.prototype.map=function(t,e,r){for(var i=(t<<16|e<<8|r<<0).toString(16);6-i.length;)i="0"+i;return i in this.__colorReductionMap||(this.__colorReductionMap[i]=n({red:t,green:e,blue:r},this.__palette)),this.__colorReductionMap[i]},t.prototype.__extractColors=function(t){for(var e=t.width*t.height,r={},i=[],o=0;o<e;++o){for(var n=t.data[4*o+0],a=t.data[4*o+1],s=t.data[4*o+2],u=(n<<16|a<<8|s<<0).toString(16);6-u.length;)u="0"+u;r[u]||(r[u]=!0,i.push({red:n,green:a,blue:s}))}return i},t.prototype.__medianCut=function(t,e){var r=new a(t);return this.__divideUntil([r],e)},t.prototype.__divideUntil=function(t,e){for(;!(t.length>=e);){var r=this.__getLargestCube(t),i=r.divide();if(i.length<2)break;t=t.filter((function(t){return t!==r})).concat(i)}return t},t.prototype.__getLargestCube=function(t){var e=null,r=0;return t.forEach((function(t){var i=t.getNumberOfColors();i>r&&(e=t,r=i)})),e},t}();e.MedianCutColorReducer=s}]);